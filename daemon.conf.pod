=head1 NAME

daemon.conf - Daemon configuration file for Daemon Manager

=head1 SYNOPSIS

  # Example conf file:
  start=./daemon_exe --flags   # Line will be interpretted by /bin/sh
  dir=/some/working/dir        # working dir        default: /
  user=nobody                  # Who to run as      default: the user
  output=log                   # "log" or "discard" default: discard
  autostart=no                 # "yes" or "no"      default: yes

=head1 DESCRIPTION

This manual page describes the config files for daemons controlled by
L<daemon-manager(1)>. The config files are loaded out of the user's home
directory: B<"~/.daemon-manager/daemons">. Root's config files are loaded from
B<"/etc/daemon-manager/daemons">. Only files with the suffix ".conf" will be
loaded.

The config files must not be world writable and must be owned by the user
whose home directory they are in.

Each config file describes a single daemon.

=head1 FILE FORMAT

The config file is a plain text file. The general format is

  option = value

White space is stripped from around options and values.

Comments are stripped from lines before they are parsed. A comment starts with
a '#' and continues to the end of a line.

Blank lines are ignored.

=head1 CONFIGURATION OPTIONS

=over

=item I<start>

This is the line that will be fed to /bin/sh in order to start the
daemon. This option is required. The daemon is required to stay in the
foreground. If it tries to daemonize then L<daemon-manager(1)> will think it
has exited prematurely and will attempt to restart it. It is also a good idea
to use B<sh>'s C<exec> built-in to jettison the shell while launching the
daemon.

=item I<dir>

This option specifies the working directory. The daemon will be started from
this directory. If the I<dir> option is not specified it defaults to "/".

=item I<user>

Use this option to specify which user the daemon should be run as. By default
users are only allowed to start daemons as themselves. The system
administrator can allow a user to run as another user by adding to the
B<run_as> section of the L<daemon-manager.conf(5)> file.

=item I<output>

This option controls whether stdout and stderr from the daemon should be
logged or discarded.

The valid values for this option are "C<log>" or "C<discard>", with
"C<discard>" being the default if the option is not specified.

If the daemons have been configured with the I<output> option set to C<log>
then their stdout and stderr will be redirected to a log file in
"~/.daemon-manager/log/<daemon>.log" where <daemon> is the basename of the
.conf file.

=item I<autostart>

If this option is "yes" or left unspecified then the daemon will be started
automatically when L<daemon-manager(5)> itself is started.

If this option is "no" then it will only be started by L<dmctl(1)>'s
"C<start>" command.

=item I<sockfile>

If this option is set to "yes" then L<daemon-manager(5)> will create a
directory with the proper permissions and pass an environment variable named
SOCK_FILE to the daemon. The socket itself is not created; that is left to
the daemon.

The socket path will be "/var/run/daemon-manager/I<< <run_as_user> >>/I<< <owner_user> >>/I<< <daemon-name> >>.socket",
where I<< <run_as_user> >> is the I<user> option in this file as described
above, I<< <owner_user> >> is the user name of the owner of the daemon (which
user's "daemons" directory it was defined in), and I<< <daemon-name> >> is the
basename of the daemon config file minus the ".conf".

The rationale is that if there are a large number of FastCGI daemons in the
system then it is convenient to have their sockets organized and guess-able
just by knowing the daemon-id (obtained from L<dmctl(1)>) and the system's
run_as policy (as defined in L<daemon-manager.conf(5)>).

=back

=head1 SEE ALSO

L<daemon-manager(1)>, L<daemon-manager.conf(5)>, L<dmctl(1)>

=cut
